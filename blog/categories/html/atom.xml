<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: HTML | Robert Mosolgo]]></title>
  <link href="http://rmosolgo.github.io/blog/categories/html/atom.xml" rel="self"/>
  <link href="http://rmosolgo.github.io/"/>
  <updated>2014-11-21T09:40:37-08:00</updated>
  <id>http://rmosolgo.github.io/</id>
  <author>
    <name><![CDATA[Robert Mosolgo]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Serving static files in WebApp2 reponses]]></title>
    <link href="http://rmosolgo.github.io/blog/2013/08/04/serving-static-files-in-webapp2-responses/"/>
    <updated>2013-08-04T19:22:00-07:00</updated>
    <id>http://rmosolgo.github.io/blog/2013/08/04/serving-static-files-in-webapp2-responses</id>
    <content type="html"><![CDATA[<p>On <a href="https://cloud.google.com/products/">Google App Engine</a>, I had to display the user-submitted image, if there was one, else display a default image.</p>

<!-- more -->


<p>The given object could only have one image, so I was using the <a href="https://developers.google.com/appengine/docs/python/ndb/properties">NDB BlobProperty</a>:</p>

<p>{% codeblock lang:python %}
class Sensor(ndb.Model):
  image = ndb.BlobProperty()
{% endcodeblock %}</p>

<p>I put the default image in my application root (alongside <code>app.yaml</code>):</p>

<p>{% codeblock lang:yaml %}
app_root:
  request_handlers:</p>

<pre><code>- __init__.py
- handlers.py
</code></pre>

<ul>
<li>app.yaml</li>
<li>default_sensor.jpg
&hellip;
{% endcodeblock %}</li>
</ul>


<p>In my request handler, I checked for the presence of an image, and gave the default image if there wasn&rsquo;t one there:</p>

<p>{% codeblock lang:python %}</p>

<h1>responds to &ldquo;/sensors/(\w+)/image&rdquo;</h1>

<p>class SensorImage(webapp2.RequestHandler):
  DEFAULT_IMAGE = &lsquo;default_sensor.jpg&rsquo;
  def get(self, hex):</p>

<pre><code>r = self.response
r.headers['Content-Type'] = "image/jpg"
this_sensor = Sensor.find_by_hex(hex)

if (not this_sensor) or (not this_sensor.image):

  image = open(SensorImage.DEFAULT_IMAGE, 'rb')
  r.body_file.write( image.read() )
  image.close()

else:
  r.body_file.write( this_sensor.image )
</code></pre>

<p>{% endcodeblock %}</p>

<p>That way, I had one URL that didn&rsquo;t change whether a user uploaded an image or not.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Handling Files in WebApp2 and Google App Engine]]></title>
    <link href="http://rmosolgo.github.io/blog/2013/08/04/handling-files-in-webapp2-and-google-app-engine/"/>
    <updated>2013-08-04T19:22:00-07:00</updated>
    <id>http://rmosolgo.github.io/blog/2013/08/04/handling-files-in-webapp2-and-google-app-engine</id>
    <content type="html"><![CDATA[<p>On <a href="https://cloud.google.com/products/">Google App Engine</a>, I had to display the user-submitted image, if there was one, else display a default image. The given object could only have on image, so I was using the <a href="https://developers.google.com/appengine/docs/python/ndb/properties">NDB BlobProperty</a>:</p>

<!-- more -->


<p>{% codeblock lang:python %}
class Sensor(ndb.Model):
  image = ndb.BlobProperty()
{% endcodeblock %}</p>

<p>I put the default image in my application root (alongside <code>app.yaml</code>):</p>

<p>{% codeblock lang:yaml %}
app_root:
  request_handlers:</p>

<pre><code>- __init__.py
- handlers.py
</code></pre>

<ul>
<li>app.yaml</li>
<li>default_sensor.jpg
{% endcodeblock %}</li>
</ul>


<p>In my request handler, I checked for the presence of an image, and gave the default image if there wasn&rsquo;t one there:</p>

<p>{% codeblock lang:python %}</p>

<h1>responds to &ldquo;/sensors/(\w+)/image&rdquo;</h1>

<p>class SensorImage(webapp2.RequestHandler):
  DEFAULT_IMAGE = &lsquo;default_sensor.jpg&rsquo;
  def get(self, hex):</p>

<pre><code>r = self.response
r.headers['Content-Type'] = "image/jpg"
this_sensor = Sensor.find_by_hex(hex)

if (not this_sensor) or (not this_sensor.image):

  image = open(SensorImage.DEFAULT_IMAGE, 'rb')
  r.body_file.write( image.read() )
  image.close()

else:
  r.body_file.write( this_sensor.image )
</code></pre>

<p>{% endcodeblock %}</p>

<p>That way, I had one URL that didn&rsquo;t change whether a user uploaded an image or not.</p>
]]></content>
  </entry>
  
</feed>
